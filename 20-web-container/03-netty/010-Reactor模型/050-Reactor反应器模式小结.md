# 040-Reactor反应器模式小结

[TOC]

## 反应器模式和生产者消费者模式对比

#### 相似之处

在一定程度上, 反应器模式优点类似生产者消费者模式, 在生产者消费者模式中一个或者多个生产者将事件放到同一个队列中, 一个或者多个消费者主动的从队列中获取事件来处理

#### 不同之处

反应器模式是基于查询的, 没有专门的队列去缓冲存储IO事件, 查询到IO事件之后, 反应器会根据不同的IO选择键(事件) 将其分发给对应的Handler处理器来处理

## 反应器模式和观察者模式对比

#### 相似之处

 在反应器模式中, 当查询到IO事件之后, 服务处理程序使用单路/ 多路复用分发策略(Dispatch)策略, 同步地分发这些IO事件

观察者(Observer Pattern) 也被称作发布/订阅模式, 它定义了一种依赖关系, 让多个观察者同时监听某一主题, 这个主题对象在动态发生变化时, 会通知所有的观察者, 它们能够执行相应的处理

#### 不同点

在反应器模式中, Handler 处理器实例和 IO事件 (选择键) 的订阅关系, 基本上是一个事件绑定到一个Handler处理器, 每一个IO事件(选择键) 被查询后, 反应器都会分发给绑定的handler处理器, 而在观察者模式中, 同一个时刻, 同一个主题可以被订阅过多个观察者处理

## Reactor反应器模式的优缺点

### 优点

- 响应快, 虽然同一个反应器线程本身是同步的, 但是不会被单个连接的同步IO所阻塞
- 编程相对简单, 最大程度上避免了复杂的多线程同步, 也避免了多线程的各个进程之间的开销
- 可拓展, 可以方便地通过增加反应器线程的个数来充分利用CPU资源

#### 反应器模式的缺点

- 反应器模式增加了复杂性, 有一定门槛, 不利于调试
- 反应器模式需要底层操作系统的IO多路复用支持, 例如 Linux 的 epoll , 如果操作系统的底层不支持IO多路复用,反应器模式就不会这么高效
- 同一个handler中, 如果出现一个长时间的数据读写, 会影响整个反应器中的其他通道的Io处理,例如大文件传输时, IO操作会影响其他客户端的(Client) 的响应时间因为对于这种操作, 还需要进一步对反应器模式进行改造